---
title: "Senate Popular Representation"
author: "Tanner Gildea"
date: "4/20/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, 
                      warning = FALSE, 
                      message = FALSE, 
                      fig.width = 8, 
                      fig.height = 5)
library(tidyverse)
library(readxl)
library(ggplot2)
library(ggthemes)
library(scales)
library(maps)

data <- read.csv("senate_votes.csv") %>% # current as of March 25 2 trillion Covid bill
  select(-district) %>% 
  na.omit() %>% 
  subset(party == 'Republican' | party == 'Democrat' | party == 'Independent')
  

us_states <- map_data("state") # for later use in state visualization
```

```{r trump_2016_vote}
trump_2016 <- data %>% select(state, net_trump_2016_vote) %>% 
  distinct() %>% 
  mutate(trump_win = case_when(net_trump_2016_vote > 0 ~ 'Yes',
                               net_trump_2016_vote < 0 ~ 'No'))
  
```


```{r senator votes}
senator_votes <- data %>% 
  select(-net_trump_2016_vote) %>% 
  mutate(votes_with_trump = votes*agree_pct) %>% 
  mutate(votes_against_trump = (votes - votes*agree_pct)) 

```

```{r state totals}

state_senate_support <- senator_votes %>% 
  group_by(state) %>% 
  mutate(senator_support_by_state = sum(votes_with_trump)) %>% 
  mutate(senator_opposition_by_state = sum(votes_against_trump)) %>% 
  mutate(total_votes_by_state = senator_support_by_state + senator_opposition_by_state) %>% 
  mutate(state_trump_support_pct = (senator_support_by_state/total_votes_by_state)*100) 

average_state_support <- state_senate_support %>% 
  select(state, state_trump_support_pct) %>% 
  distinct()
         
```


```{r difference}

difference <- average_state_support %>% 
  left_join(trump_2016) %>% 
  mutate(net_senate_support = state_trump_support_pct - 50) %>% 
  mutate(trump_senate_difference = net_senate_support - net_trump_2016_vote) 
  
```


```{r vlines}
party_colors <- c("#2E74C0", "#CB454A") # Dem and GOP colors

# trump state vote over clinton
ggplot(trump_2016,
       aes(x = net_trump_2016_vote,
           y = reorder(state, net_trump_2016_vote),
           color = trump_win)) +
  
  geom_vline(xintercept = 0, color = "purple", size = 2) +
  geom_point(size = 4) +
  
  scale_x_continuous(breaks = c(-30,-20,-15,-10,-5,-2.5,0,2.5,5,10,15,20,30,45),
                     labels = c("-30", "-20", "-15", "-10", "-5", "-2.5", "0", "+2.5", "+5", "+10", "+15", "+20", "+30", "+45")) +
  scale_color_manual(values = party_colors) +
  
  labs(title = "Trump Vote Margin Over Clinton, 2016",
       subtitle = "As Percentage Point",
       x = "", y = "",
       caption = "Source: FiveThirtyEight") +
  guides(color = FALSE) +
  theme_tufte() +
  theme(axis.text.x = element_text(size = 20),
        axis.ticks = element_blank(),
        axis.text.y = element_text(size = 12),
        plot.title = element_text(size = 30, color = "purple"),
        plot.subtitle = element_text(size = 20),
        panel.grid.major = element_line(color = "gray"))


# average senate agreement with trump









```


